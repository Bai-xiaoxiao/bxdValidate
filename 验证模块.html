function SecuritySetting() {
    
}

SecuritySetting.prototype = {
    initPage: function () {
        this.passwordContent();
        this.phoneContent();
        this.questionContent();
        this.setWizard();
        this.validata();
    },
    passwordContent: function () {
        //修改密码
        $('#setPassword').click(function () {
            $('.SecuritySetting').hide();
            $('.passwordContent').show();
        });
    },
    phoneContent: function () {
        //修改手机号码
        $('#setPhone').click(function () {
            $('.SecuritySetting').hide();
            $('#phoneContent').show();
        });
        $('.changeType').click(function () {
            if ($('.phoneType').attr('data-type') == 'true') {
                $('.phoneType').attr('data-type', 'false').hide();
                $('.questionType').attr('data-type', 'true').show();
            } else {
                $('.phoneType').attr('data-type', 'true').show();
                $('.questionType').attr('data-type', 'false').hide();
            }
        });
        //验证密码失焦
        $('.phoneType input').blur(function () {
            var itp = $(this);
            if (itp.val()) {
                itp.attr('data-original-title', '').tooltip('show');
                itp.parent().removeClass('has-error');
            } else {
                itp.attr('data-original-title', '请输入验证码').tooltip('show');
                itp.parent().addClass('has-error');
            }
        });
        //第一步-手机验证-提交
        //$('.phoneType .step1_next').click(function () {
        //    var itp = $('.phoneType input');
        //    if (itp.val()) {
        //        itp.attr('data-original-title', '').tooltip('show');
        //        itp.parent().removeClass('has-error');
        //        alert('提交');
        //        $('#wizard').wizard('goTo', 1);
        //        $("#phoneContent .step2_next").click(function () {
        //            $('#wizard').wizard('goTo', 2);
        //        });
        //    } else {
        //        itp.attr('data-original-title', '请输入验证码').tooltip('show');
        //        itp.parent().addClass('has-error');
        //    }
        //});
        //第一步-问题验证-提交
        //$('.questionType .step1_next').click(function () {
            //var a1 = $('.anser1'),
            //    a2 = $('.anser2'),
            //    a3 = $('.anser3');
            //if (!a1.val()) {
            //    a1.attr('data-original-title', '请输入问题答案').tooltip('show');
            //    a1.parent().addClass('has-error');
            //} else {
            //    alert('提交');
            //    $('#wizard').wizard('goTo', 1);
            //    $("#phoneContent .step2_next").click(function () {
            //        $('#wizard').wizard('goTo', 2);
            //    });
            //}
        //});
    },
    questionContent: function () {
        //修改安全问题
        $('#setQuestion').click(function () {
            $('.SecuritySetting').hide();
            $('#questionContent').show();
        });
    },
    //生成步骤插件
    setWizard: function () {
        var wizard = $('#wizard').wizard({
            templates: {
                buttons: function buttons() {// 去掉前后的button
                    return '';
                }
            }
        }).data('wizard');
        var wizard = $('#wizard2').wizard({
            templates: {
                buttons: function buttons() {// 去掉前后的button
                    return '';
                }
            }
        }).data('wizard');
    },
    showError: function (err) {
       
    },
    validata: function () {
        //更改校验组件错误信息显示方式
        $.extend($.validator.messages, {
            required: "这是必填字段"
        });
        $.validator.addMethod("valPhone", function (value, element) {
            var reg = /^0?(13|15|18|14|17)[0-9]{9}$/;
            return this.optional(element) || (reg.test(value));
        }, "请输入正确的手机号码");
        //验证密码
        $.validator.addMethod("valnewPassword", function (value, element) {
            var reg = /^[a-zA-Z0-9]{8,16}$/;
            return this.optional(element) || (reg.test(value));
        }, "密码必须为8-16位数字或字母");
        //重复密码
        $.validator.addMethod("valRePassword", function (value, element) {
            return this.optional(element) || $(element).val() == $('input[name="newpassword"]').val();
        }, "密码不一致，请确认密码");
        $.validator.setDefaults({
            onkeyup: false,
            showErrors: function (errorMap, errorList) {
                if (errorList.length == 0) {
                    if (window.event || arguments.callee.caller.arguments[0]) {
                        var event = window.event || arguments.callee.caller.arguments[0];
                        var target = event.srcElement || event.target;
                    } else {
                        var target = arguments.callee.caller.caller.arguments[0]
                    }
                    $(target).parent().removeClass('has-error');
                    $(target).attr('data-original-title', '').tooltip('show');
                    return;
                }
                for (var i = 0; i < errorList.length; i++) {
                    var errorElement = $(errorList[i].element);
                    errorElement.parent().addClass('has-error');
                    errorElement.attr('data-original-title', errorList[i].message).tooltip('show');
                }
            },
        });
        //修改密码
        $("#passwordForm").validate({
            rules: {
                newpassword: {
                    valnewPassword: true
                },
                repasswoasrd: {
                    valRePassword: true
                }
            },
            submitHandler: function () {
                alert("提交事件!");
                $('.passwordStep').hide();
                $('.passwordSuccess').show();
            }
        });
        //绑定手机第一步--获取验证码
        $('#getCodeForm1').validate({
            submitHandler: function () {
                alert('提交');
                $('#wizard').wizard('goTo', 1);
            }
        });
        //绑定手机第一步--回答问题方式
        $('#answerForm').validate({
            submitHandler: function () {
                alert('提交');
                $('#wizard').wizard('goTo', 1);
            }
        });
        //绑定手机第二步--绑定新手机号
        $('#getCodeForm2').validate({
            rules: {
                newPhone: {
                    valPhone: true
                }
            },
            submitHandler: function () {
                alert('提交');
                $('#wizard').wizard('goTo', 2);
            }
        });
        //设置问题第一步获取验证码
        $('#getCodeForm3').validate({
            submitHandler: function () {
                alert('提交');
                $('#wizard2').wizard('goTo', 1);
            }
        });
        //设置问题第二步
        $('#setAnswerForm').validate({
            submitHandler: function () {
                alert('提交');
                $('#wizard2').wizard('goTo', 2);
            }
        });
    }
}
